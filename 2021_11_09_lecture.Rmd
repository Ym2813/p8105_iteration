---
title: "Iteration and list columns"
author: "Anna Ma"
date: "11/13/2021"
output: github_document
---

```{r}
library(tidyverse)

set.seed(1)
```

## Define Function 

```{r}
mean_and_sd = function(x) {
  
  if (!is.numeric(x)) {
    stop("Argument x should be numeric")
  } else if (length(x) == 1) {
    stop("Cannot be computed for length 1 vectors")
  }
  
  mean_x = mean(x)
  sd_x = sd(x)

  output_df = 
    tibble(mean = mean_x, 
       sd = sd_x)
  # or use list(mean = mean_x, sd = sd_x)
  return(output_df)
}
```

## Lists

```{r}
l = 
  list(
    vec_numeric = 5:8,
    vec_logical = c(TRUE, FALSE),
    summary = summary(rnorm(1000, mean = 5, sd = 3))
)

# 3 ways to access the third element of this list:

l[[3]]

l[["summary"]]

l$summary

```

## List of normals

```{r}
list_norms = 
  list(
    a = rnorm(50, mean = 2, sd = 1),
    b = rnorm(50, mean = 5, sd = 3),
    c = rnorm(50, mean = 20, sd = 1.2),
    d = rnorm(50, mean = -12, sd = 0.5)
  )
```

## Use function on list 

```{r}
#This uses the element sequence.
mean_and_sd(list_norms[[1]])
# or mean_and_sd(list_norms[["a"]]) this use name
```


## For loop

lets use a for loop to iterate over the list of normals. 

Steps to do it:
1. Identify the input. In this case, the input is the list of normals
2. Figure out the output. We want a vector that is a list and have 4 open spots. 
3. Know the function that we want to apply to the input
4. Use function on the input list and put the result into the output list

```{r, include = FALSE}
output = vector("list",length = 4)
# This creates a empty list with 4 spots

output[[1]] = mean_and_sd(list_norms[[1]])
# use mean and sd function on the first element in the in put list, and put the result as the first element in the out put list that we just created 
```

Now, we can use a for loop to iterate what we did on a single element to create a complete list for all the elements in the list. 

```{r}
for (i in 1:4) {
  output[[i]] = mean_and_sd(list_norms[[i]])
}

output
```

Lets use map instead

```{r}
#map input on to the function and return output for all 
output_map = map(list_norms, mean_and_sd)

output_map

# same result with for loop

# we can also do 
map(list_norms, median)
map(list_norms, summary)
map(list_norms, IQR)
```

If we want to access element in the list, use: 
```{r}
output[[1]]
```

If we know the type of data that the output will be, we can do this an dget a simpler output. 

```{r}
map_dbl(list_norms, median)
```

## List Columns!!